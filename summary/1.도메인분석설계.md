# 도메인 분석 설계

---

## 요구사항 분석

### 기능 목록

+ 회원 기능
  + 회원 등록
  + 회원 조회
+ 상품 기능
  + 상품 등록
  + 상품 수정
  + 상품 조회
+ 주문 기능
  + 상품 주문
  + 주문 내역 조회
  + 주문 취소
+ 기타 요구사항
  + 상품은 재고 관리가 필요하다.
  + 상품의 종류는 도서, 음반, 영화가 있다.
  + 상품을 카테고리로 구분할 수 있다.
  + 상품 주문시 배송 정보를 입력할 수 있다.

---

## 도메인 모델과 테이블 설계

![img1](../img/img1.PNG)

회원과 주문: 회원은 여러 상품을 주문할 수 있다.

주문과 상품: 다대다 관계를 일대다 다대일 관계로 풀어서 사용

상품 분류: 상품은 도서, 음반, 영화로 구분되고 공통 속성을 사용하므로 상속 구조를 사용

### 엔티티

![img2](../img/img2.PNG)

**회원**: 이름과 임베디드 타입인 Address, orders 리스트를 가짐

**주문**: 한 번 주문시 여러 상품을 주문할 수 있으므로 주문상품과(OrderItem)과는 일대다 관계

**카테고리**: 상품과 다대다 관계, `parent`,`child`로 부모, 자식 카테고리 연결

### 회원 테이블

![img3](../img/img3.PNG)

**MEMBER**: MEMBER 테이블과 DELIVERY 테이블에 `Address`임베디드 타입 정보가 들어감

**ITEM**: 앨범, 도서, 영화 타입을 통합해서 하나의 테이블로 생성(SINGLE TABLE 전략)


### 연관관계 매핑

+ 회원과 주문: 일대다, 다대일의 양방향 관계이므로 연관계의 주인을 정해야 한다. 이 때 외래키가 있는 쪽을 주인으로 정한다. `Order.member`를 `ORDERS.MEMBER_ID` 외래 키와 매핑한다.

+ 주문상품과 주문(ORDER_ITEM, ORDER): 다대일 양방향 관게, `OrderItem.order`를 `ORDER_ITEM.ORDER_ID` 외래 키와 매핑

+ 주문과 배송: 일대일 양방향 관계. 아무곳이나 주인이 될 수 있다. 여기서는 `Order.delivery`를 `ORDEERS.DELIVEY_ID`외래 키와 매핑